import"./modulepreload-polyfill-B5Qt9EMX.js";import{q as o,g as u,s as g,u as b,a as S,l as v,b as D}from"./utils-B75w2TNQ.js";import{P as T,r as W}from"./ProductData-BeRx2sQe.js";class ${constructor(e,t){this.productId=e,this.product={},this.dataSource=t}async init(){this.product=await this.dataSource.findProductById(this.productId),this.renderProductDetails();const e=o("#addToCart");e&&e.addEventListener("click",this.addProductToCart.bind(this)),this.initCarousel(),this.initColors(),this.initWishList(),this.initComments()}addProductToCart(){const e={...this.product};this.selectedColor&&(e.SelectedColor=this.selectedColor);const t=u("so-cart")||[];t.push(e),g("so-cart",t),b(),S()}renderProductDetails(){var f,x,L,I,P;if(!this.product)return;const e=o("#productBrand"),t=o("#productName"),r=o("#productImage"),c=o("#productPrice"),s=o("#productDiscount"),i=o("#productColor"),a=o("#productDescription"),p=o("#addToCart");if(e&&(e.textContent=((f=this.product.Brand)==null?void 0:f.Name)||""),t&&(t.textContent=this.product.NameWithoutBrand||this.product.Name||""),r){let d=((x=this.product.Images)==null?void 0:x.PrimaryLarge)||((L=this.product.Images)==null?void 0:L.PrimaryMedium)||this.product.Image||"";const m="/WDD330/images/";if(d=d.replace(/\.\.\/images\//g,m),r.src=d,this.product.Images){const n=[];this.product.Images.PrimarySmall&&n.push(`${this.product.Images.PrimarySmall.replace(/\.\.\/images\//g,m)} 300w`),this.product.Images.PrimaryMedium&&n.push(`${this.product.Images.PrimaryMedium.replace(/\.\.\/images\//g,m)} 500w`),this.product.Images.PrimaryLarge&&n.push(`${this.product.Images.PrimaryLarge.replace(/\.\.\/images\//g,m)} 1000w`),this.product.Images.PrimaryExtraLarge&&n.push(`${this.product.Images.PrimaryExtraLarge.replace(/\.\.\/images\//g,m)} 1500w`),n.length>0&&(r.srcset=n.join(", "),r.sizes="(max-width: 600px) 300px, (max-width: 900px) 500px, 1000px")}r.alt=this.product.Name||""}c&&(c.textContent=`$${(this.product.FinalPrice??this.product.ListPrice??0).toFixed(2)}`);const h=this.product.SuggestedRetailPrice??this.product.ListPrice??0,C=this.product.FinalPrice??this.product.ListPrice??0;if(s&&h>C){const d=h-C,m=Math.round(d/h*100);s.textContent=`Save ${m}% ($${d.toFixed(2)} off)`}else s&&(s.textContent="");if(i&&(i.textContent=((P=(I=this.product.Colors)==null?void 0:I[0])==null?void 0:P.ColorName)||""),a){const d=this.product.DescriptionHtmlSimple||this.product.Description||"",n=new DOMParser().parseFromString(d,"text/html");n.querySelectorAll("a.glossaryTermLink").forEach(E=>{const w=E.textContent;E.replaceWith(w)}),a.textContent=n.body.textContent}p&&(p.dataset.id=this.product.Id||"")}initCarousel(){var e;if((e=this.product.Images)!=null&&e.ExtraImages&&this.product.Images.ExtraImages.length>0){o(".product-detail");const t=o("#productImage");if(!t)return;const r=document.createElement("div");r.classList.add("carousel-thumbnails"),this.product.Images.ExtraImages.forEach(c=>{const i=c.Src.replace(/\.\.\/images\//g,"/WDD330/images/"),a=document.createElement("img");a.src=i,a.alt=c.Title||"Extra Image",a.classList.add("carousel-thumb"),a.addEventListener("click",()=>{t.src=i,t.srcset=""}),r.appendChild(a)}),t.parentNode.insertBefore(r,t.nextSibling)}}initColors(){if(this.product.Colors&&this.product.Colors.length>1){const e=o("#productColor");if(!e)return;e.innerHTML="";const t=document.createElement("p");t.textContent="Select Color:",e.appendChild(t);const r=document.createElement("div");r.classList.add("color-swatches"),this.product.Colors.forEach(c=>{const s=document.createElement("button");s.textContent=c.ColorName,s.classList.add("color-swatch"),s.addEventListener("click",()=>{this.selectedColor=c;const i=e.querySelector(".color-swatch.selected");i&&i.classList.remove("selected"),s.classList.add("selected")}),r.appendChild(s)}),e.appendChild(r)}}initWishList(){const e=o(".product-detail__add");if(!e)return;let t=o("#addToWishList");t||(t=document.createElement("button"),t.id="addToWishList",t.textContent="❤ Add to Wish List",t.classList.add("wishlist-btn"),e.appendChild(t)),(u("so-wishlist")||[]).find(s=>s.Id===this.product.Id)&&(t.textContent="❤ In Wish List",t.classList.add("active")),t.addEventListener("click",s=>{s.stopPropagation();let i=u("so-wishlist")||[];const a=i.findIndex(p=>p.Id===this.product.Id);a>=0?(i.splice(a,1),t.textContent="❤ Add to Wish List",t.classList.remove("active")):(i.push(this.product),t.textContent="❤ In Wish List",t.classList.add("active")),g("so-wishlist",i)})}initComments(){const e=o(".product-detail");if(!e||o(".product-comments"))return;const t=document.createElement("div");t.classList.add("product-comments"),t.innerHTML=`
      <h3>Customer Comments</h3>
      <ul id="commentsList"></ul>
      <form id="commentForm">
        <textarea id="commentText" placeholder="Write a comment..." required></textarea>
        <button type="submit">Submit Comment</button>
      </form>
    `,e.appendChild(t),this.renderComments(),o("#commentForm").addEventListener("submit",r=>{r.preventDefault();const c=o("#commentText").value,s=u(`so-comments-${this.product.Id}`)||[];s.push({text:c,date:new Date().toLocaleDateString()}),g(`so-comments-${this.product.Id}`,s),o("#commentText").value="",this.renderComments()})}renderComments(){const e=o("#commentsList");if(!e)return;const t=u(`so-comments-${this.product.Id}`)||[];e.innerHTML="",t.forEach(r=>{const c=document.createElement("li"),s=document.createElement("p");s.textContent=r.text;const i=document.createElement("small");i.textContent=r.date,c.appendChild(s),c.appendChild(i),e.appendChild(c)})}}v();const y=D("product"),B=new T("tents");y&&(async()=>{try{const l=new $(y,B);await l.init(),l.product.Category&&W(l.product.Category)}catch(l){console.error("Product load error:",l);const e=document.querySelector("main");e&&(e.innerHTML="<p>Error loading product details.</p>")}})();
