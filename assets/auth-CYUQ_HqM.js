import{s as i,g as c}from"./utils-DycB6jvq.js";const n="https://wdd330-backend.onrender.com/";async function l(o,t="/"){const r=t.startsWith("/")&&!t.startsWith("//")?t:"/";try{const e=await fetch(n+"login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!e.ok){const s=await e.json().catch(()=>({}));alert(s.message||"Login failed");return}const a=await e.json();i("so_token",a.accessToken),window.location.href=r}catch(e){console.error(e),alert("Login failed due to a network error.")}}function u(){const o=c("so_token");if(!o){const t=window.location.pathname;return window.location.href=`/WDD330/login/index.html?redirect=${encodeURIComponent(t)}`,!1}return o}async function h(o){try{const t=await fetch(n+"orders",{headers:{Authorization:`Bearer ${o}`}});if(t.status===401)return{unauthorized:!0,data:[]};if(!t.ok)throw new Error(`Orders request failed: ${t.status}`);const r=await t.json();return{unauthorized:!1,data:Array.isArray(r)?r:[]}}catch(t){return console.error(t),{unauthorized:!1,data:[]}}}async function f(o,t="/"){const r=t.startsWith("/")&&!t.startsWith("//")?t:"/";try{const e=await fetch(n+"users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!e.ok){const a=await e.json().catch(()=>({}));alert(a.message||"Registration failed");return}alert("Registration successful! Please login."),window.location.href=r}catch(e){console.error(e),alert("Registration failed due to a network error.")}}export{u as c,l,h as o,f as r};
